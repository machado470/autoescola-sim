services:
  postgres:
    # Se o serviço no seu compose tiver outro nome, troque aqui para o mesmo nome.
    healthcheck:
      test: ["CMD-SHELL","pg_isready -U postgres"]
      interval: 5s
      timeout: 3s
      retries: 30

  api:
    environment:
      # Use SEMPRE o nome do serviço como host (aqui: 'postgres')
      DATABASE_URL: postgresql://postgres:postgres@postgres:5432/autoescola
    depends_on:
      postgres:
        condition: service_healthy
